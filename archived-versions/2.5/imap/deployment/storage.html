

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Storage Considerations &mdash; Cyrus IMAP 2.5.17 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/cyrus.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Cyrus IMAP 2.5.17 documentation" href="../../index.html"/>
        <link rel="up" title="IMAP Configuration Guide" href="../deployment.html"/>
        <link rel="next" title="Supported Platforms and System Requirements" href="supported-platforms.html"/>
        <link rel="prev" title="Performance Recommendations" href="performance_recommendations.html"/> 

  
  
  

</head>

<body class="wy-body-for-nav" role="document">

  
  
<div class="pageheader">
  <ul>
    <li><a href="../../index.html">Home</a></li>
    <li><a href="../installation.html">Download</a></li>
    <li><a href="../../contribute.html">Contribute</a></li>
    <li><a href="../../feedback.html">Support</a></li>
  </ul>
  <div>
    <a href="../../index.html">
      <h1>Cyrus IMAP</h1>
      <!-- <img src="../../_static/logo.gif" alt="CYRUS" /> -->
    </a>
  </div>
</div>
<div style="clear: both;"></div>


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
 
          <a href="../../index.html">
 

          
          <h1>Cyrus IMAP</h1>
          
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">Welcome to Cyrus</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction to Cyrus IMAP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#what-is-imap">What is IMAP?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">IMAP Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features.html#security-and-authentication">Security and Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/authentication-kerberos.html">Kerberos Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/authentication-ldap.html">LDAP Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/authentication-sql.html">SQL Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/authentication-sql.html#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/authentication-sql.html#database-structure">Database structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/authentication-sql.html#pam-configuration-for-use-with-saslauthd">PAM configuration for use with saslauthd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/authentication-sql.html#testing-the-sasl-configuration">Testing the SASL configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/authentication-sql.html#create-the-test-mailboxes-within-cyrus">Create the test mailboxes within Cyrus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/authentication-sql.html#testing-everything-together">Testing everything together</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/access-control.html">Access Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/access-control.html#discretionary-access-control">Discretionary Access Control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/sealed-system.html">Sealed System Design</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#mailbox-management">Mailbox Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/automatic-creation-of-mailboxes.html">Automatic Creation of Mailboxes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/automatic-creation-of-mailboxes.html#autocreation-of-mailboxes">Autocreation of mailboxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/automatic-creation-of-mailboxes.html#automatic-quota-settings">Automatic quota settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/automatic-creation-of-mailboxes.html#autocreation-of-sieve-scripts">Autocreation of Sieve scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/automatic-creation-of-mailboxes.html#automated-folder-subscriptions">Automated folder subscriptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/automatic-creation-of-mailboxes.html#autocreation-of-users">Autocreation of users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/namespaces.html">Mailbox Namespaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#namespace-convention-netnews">Namespace Convention: <strong>netnews</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#namespace-convention-not-netnews">Namespace Convention: “not netnews”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#alternate-namespace">Alternate Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#internal-namespace">Internal Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#administrator-namespaces">Administrator Namespaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#imap-features-namespaces-personal">Personal Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#other-users-namespace">Other Users Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/namespaces.html#shared-namespaces">Shared Namespaces</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/mailbox-annotations.html">Mailbox Annotations (METADATA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/mailbox-distribution.html">Mailbox Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/mailbox-distribution.html#partition-selection-mode">Partition Selection Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/mailbox-distribution.html#backend-selection-mode-cyrus-imap-murder">Backend Selection Mode (Cyrus IMAP Murder)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#message-management">Message Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/delayed-delete.html">Delayed Delete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/delayed-delete.html#configuring-cyrus-imap-for-delayed-delete">Configuring Cyrus IMAP for Delayed Delete</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/delayed-expunge.html">Delayed Expunge</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/delayed-expunge.html#configuring-cyrus-imap-for-delayed-expunge">Configuring Cyrus IMAP for Delayed Expunge</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/message-annotations.html">Message Annotations (METADATA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/duplicate-message-delivery-suppression.html">Duplicate Message Delivery Suppression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/shared-seen-state.html">Shared Seen State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/server-side-filtering.html">Server Side Filtering (Sieve)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/event-notifications.html">Event Notifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/event-notifications.html#available-event-notifications">Available Event Notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/event-notifications.html#example-event-notifications">Example Event Notifications</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#storage">Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/mail-spool-partitions.html">Mail Spool Partitions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/mail-spool-partitions.html#storage-tiering-with-partitions">Storage Tiering with Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/mail-spool-partitions.html#restricting-storage-used-with-partitions">Restricting Storage Used with Partitions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/mailbox-metadata-partitions.html">Mailbox Metadata Partitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/quota.html">Quota</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/single-instance-store.html">Single-Instance Store</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#load-management">Load Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/server-aggregation.html">Cyrus IMAP Murder (Server Aggregation)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/server-aggregation.html#use-cases-for-the-cyrus-imap-murder">Use-Cases for the Cyrus IMAP Murder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/server-aggregation.html#cyrus-imap-murder-topologies">Cyrus IMAP Murder Topologies</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../feedback.html">Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../feedback-bugs.html">Reporting Bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../feedback-mailing-lists.html">Mailing Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../feedback-meetings.html">Online Meetings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/about_cyrus.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../overview/what_is_cyrus.html">What is Cyrus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview/what_is_cyrus.html#what-is-cyrus">What is Cyrus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/what_is_cyrus.html#what-is-imap">What is IMAP?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/what_is_cyrus.html#imap-version-4-imap4">IMAP Version 4 (IMAP4)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/what_is_cyrus.html#mime">Mime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/what_is_cyrus.html#smtp">SMTP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/who_is_cyrus.html">Who Is Cyrus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview/who_is_cyrus.html#core-contributors">Core Contributors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/who_is_cyrus.html#individual-contributors-and-past-contributors">Individual contributors and past contributors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/cyrus_roadmap.html">Cyrus Roadmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_roadmap.html#high-level-roadmap">High Level Roadmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../overview/cyrus_roadmap.html#future">2.6 (Future)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview/cyrus_roadmap.html#id2">2.5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview/cyrus_roadmap.html#x">2.4.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview/cyrus_roadmap.html#x-and-2-3-x">2.2.x and 2.3.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview/cyrus_roadmap.html#pre-2-2">pre 2.2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/cyrus_history.html">Cyrus History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/cyrus_bylaws.html">Cyrus Bylaws</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_bylaws.html#i-the-cyrus-governance-board">I. The Cyrus Governance Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_bylaws.html#ii-the-cyrus-core-developers-group">II. The Cyrus Core Developers Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_bylaws.html#iii-the-release-engineer">III. The Release Engineer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_bylaws.html#iv-the-cyrus-roadmap">IV. The Cyrus Roadmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_bylaws.html#v-development-process">V. Development Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/cyrus_bylaws.html#vi-changes-to-the-bylaws">VI. Changes to the Bylaws</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Administrators</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">IMAP Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-using-packages">Installation Using Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/distributions/centos.html">CentOS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/distributions/centos.html#other-versions-of-cyrus-imap">Other Versions of Cyrus IMAP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/distributions/debian.html">Debian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/distributions/fedora.html">Fedora</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/distributions/fedora.html#other-versions-of-cyrus-imap">Other Versions of Cyrus IMAP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/distributions/opensuse.html">openSUSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/distributions/rhel.html">Red Hat Enterprise Linux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/distributions/rhel.html#other-versions-of-cyrus-imap">Other Versions of Cyrus IMAP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/distributions/ubuntu.html">Ubuntu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/obs.html">Open Build System Packages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/obs.html#series">2.5 Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/obs.html#id2">2.4 Series</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#build-and-install-yourself">Build and Install Yourself</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/diy.html">Do It Yourself</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/diy.html#from-git">From GIT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/diy.html#from-tarball">From Tarball</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/diy.html#build-dependencies">Build Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/diy.html#configure-the-build">Configure the Build</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#external-tools">External Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#licensing">Licensing</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../deployment.html">IMAP Configuration Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#a-guide-to-planning-a-cyrus-imap-deployment">A Guide to Planning a Cyrus IMAP Deployment</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../deployment.html#contents">Contents</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="overview_and_concepts.html">Overview and Concepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview_and_concepts.html#cyrus-imap">Cyrus IMAP</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview_and_concepts.html#cyrus-imap-features">Cyrus IMAP Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview_and_concepts.html#initial-acls-for-newly-created-mailboxes">Initial ACLs for Newly Created Mailboxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview_and_concepts.html#login-authentication">Login Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview_and_concepts.html#quota">Quota</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview_and_concepts.html#html-block-that-was-commented-out-in-xml">HTML Block that was commented out in XML</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview_and_concepts.html#partitions">Partitions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment_scenarios.html">Deployment Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment_scenarios.html#single-server-deployments">Single Server Deployments</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment_scenarios.html#multi-server-deployments">Multi Server Deployments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment_scenarios.html#id1">Cyrus IMAP Murder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment_scenarios.html#the-discrete-murder">The Discrete Murder</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment_scenarios.html#the-unified-murder">The Unified Murder</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment_scenarios.html#the-shared-murder">The Shared Murder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment_scenarios.html#cyrus-replication">Cyrus Replication</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment_scenarios.html#hosted-environments">Hosted Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment_scenarios.html#mailbox-creation-distribution">Mailbox Creation Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html">Mailbox Creation Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#selection-mode">Selection Mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html#usage-convergence">Usage convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html#computed-weight">Computed weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html#special-cases">Special cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#what-happens-when-two-partitions-are-equal-as-most-fitting">What happens when two partitions are equal as most fitting?</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#what-happens-when-two-partitions-point-to-the-same-device">What happens when two partitions point to the same device?</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#partitions-exclusion">Partitions Exclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#partitions-usage-data-reset">Partitions Usage Data Reset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html#mailbox-creation-distribution-through-murder-frontend">Mailbox Creation Distribution Through <code class="docutils literal notranslate"><span class="pre">murder</span> <span class="pre">frontend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#id2">Selection Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailbox_creation_distribution.html#available-selection-modes-on-frontend">Available Selection Modes on Frontend</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html#backends-exclusion">Backends Exclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="mailbox_creation_distribution.html#backends-usage-data-reset">Backends Usage Data Reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="known_protocol_limitations.html">Known Protocol Limitations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="known_protocol_limitations.html#pop3-and-mailbox-locking">POP3 and Mailbox Locking</a></li>
<li class="toctree-l4"><a class="reference internal" href="known_protocol_limitations.html#cyrus-imap-pop3-implementation">Cyrus IMAP POP3 Implementation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="authentication_and_authorization.html">Authentication and Authorization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="authentication_and_authorization.html#client-authentication">Client Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="authentication_and_authorization.html#users-and-mailboxes">Users and Mailboxes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="performance_recommendations.html">Performance Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="performance_recommendations.html#databases-on-temporary-filesystems">Databases on Temporary Filesystems</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Storage Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#general-notes-on-storage">General Notes on Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#redundancy">Redundancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#availability">Availability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance">Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scalability">Scalability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#capacity">Capacity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cost">Cost</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="supported-platforms.html">Supported Platforms and System Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="supported-platforms.html#building-cyrus-imap">Building Cyrus IMAP</a></li>
<li class="toctree-l4"><a class="reference internal" href="supported-platforms.html#required-software-components">Required Software Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="supported-platforms.html#recommended-software-components">Recommended Software Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="supported-platforms.html#recommended-software-components-enabled-by-default">Recommended Software Components Enabled by Default</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">IMAP Administrator Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../admin.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/architecture.html">System Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#high-level-architecture">High Level Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#cyrus-murder">Cyrus Murder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#replication">Replication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#invoking-cyrus">Invoking Cyrus</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin.html#management">Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/murder/murder.html">Cyrus Murder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/murder/murder-concepts.html">Cyrus Murder: Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/murder/murder-installation.html">Cyrus Murder: Installation and Administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/murder/murder-mupdate-details.html">Cyrus Murder Mupdate Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/murder/murder-failure-modes.html">Cyrus Murder Failure Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/murder/murder-mail-delivery.html">Cyrus Murder Mail Delivery</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/access-control.html">Access Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/access-control/combining-rights.html">Combining Access Rights</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/access-control/defaults.html">Access Control Defaults</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/access-control/rights-reference.html">Access Control Lists Rights Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/access-control.html#discretionary-access-control">Discretionary Access Control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/nntp.html">Cyrus NNTP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/nntp.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/nntp.html#nntp-setup">NNTP Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/nntp.html#defining-newsgroups">Defining Newsgroups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/nntp.html#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/nntp.html#further-information">Further information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/protlayer.html">Cyrus Prot Layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/protlayer.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/sieve.html">Cyrus Sieve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/sieve.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sieve.html#installing-sieve">Installing Sieve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sieve.html#managing-sieve-scripts">Managing Sieve Scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sieve.html#testing-the-sieve-server">Testing the sieve server</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sieve.html#cyrus-sieve-support">Cyrus Sieve Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sieve.html#writing-sieve">Writing Sieve</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/sop.html">Standard Operating Procedures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/replication.html">Replication: Installation and Administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/mailbox-operations.html">Mailbox Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/reloading.html">Reloading Cyrus IMAP Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/altnamespace.html">Alternative Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/databases.html">Database Conversion, Export and Import</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/deleting.html">Deleting and Undeleting Messages and Folders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/virtual-domains.html">Cyrus Virtual Domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/administration-running.html">Running Cyrus IMAP Services on Non-Standard Ports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/reconstructing.html">Reconstructing Mailboxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/squatter.html">Using Squatter for Faster IMAP SEARCH</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/splitting-metadata.html">Splitting Metadata from Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/sop/userdeny.html">Managing user_deny.db</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/eventsource.html">Cyrus Event Source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/eventsource.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/eventsource.html#compile-options">Compile options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/eventsource.html#configuration-options">Configuration options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/eventsource.html#event-types">Event Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/eventsource.html#accessing-events">Accessing events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/eventsource.html#apple-push-service">Apple Push Service</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/config-mailboxdistribution.html">Mailbox Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/config-mailboxdistribution.html#selection-modes">Selection Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/config-mailboxdistribution.html#special-cases">Special cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/config-mailboxdistribution.html#application">Application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/nginx-proxy.html">HOWTO: Using an NGINX IMAP Proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/tweaking.html">Tweaking Cyrus IMAP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/tweaking.html#storage-tiering">Storage Tiering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/tweaking.html#synchronous-file-operations">Synchronous File Operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin.html#references">References</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/commands.html">Administrative Commands &amp; Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/commands.html#list-of-configuration-files-formats-and-settings">List of Configuration Files, Formats and Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/commands.html#list-of-system-command-line-utilities">List of System Command-line Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/commands.html#list-of-user-command-line-utilities">List of User Command-line Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/commands.html#work-in-progress">Work-in-Progress</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/pycommands.html">PyCyrus Commands &amp; Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/pycommands/undelete-mailbox.html"><code class="docutils literal notranslate"><span class="pre">undelete-mailbox</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/administration-tools.html">Tools &amp; Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#arbitron">arbitron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#arbitronsort-pl">arbitronsort.pl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#chk-cyrus">chk_cyrus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#convert-sieve-pl">convert-sieve.pl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#ctl-cyrusdb">ctl_cyrusdb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#ctl-deliver">ctl_deliver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#ctl-mboxlist">ctl_mboxlist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cvt-cyrusdb">cvt_cyrusdb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cvt-cyrusdb-all">cvt_cyrusdb_all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyr-dbtool">cyr_dbtool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyr-df">cyr_df</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyrdump">cyrdump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyr-expire">cyr_expire</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#fetchnews">fetchnews</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyr-sequence">cyr_sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyr-synclog">cyr_synclog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#cyr-userseen">cyr_userseen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#masssievec">masssievec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#mbexamine">mbexamine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#mbpath">mbpath</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#migrate-metadata">migrate-metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#mkimap">mkimap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#mknewsgroups">mknewsgroups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#rehash">rehash</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#translatesieve">translatesieve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#undohash">undohash</a></li>
<li class="toctree-l4"><a class="reference internal" href="../admin/administration-tools.html#upgradesieve">upgradesieve</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../admin/access-control/rights-reference.html">Access Control Lists Rights Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin.html#other">Other</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/packagers.html">Notes for Packagers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../admin/packagers.html#services-in-etc-services">Services in <code class="docutils literal notranslate"><span class="pre">/etc/services</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">IMAP Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#features">Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/feature-database-backend.html">Which database backend should I use for which databases?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/feature-duplicate-delivery.html">Duplicate Delivery Suppression</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#installation-problems">Installation Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/install-compilationerrors.html">Compilation errors about kssl.h and krb5.h on Red Hat Linux/Fedora</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/install-detecting-berkeley.html">Problems detecting Berkley DB on Red Hat Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/install-install-help.html">Help! There must be an easier way to get all this going…</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#common-feature-requests">Common Feature Requests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/r-murder-ha.html">Does the Cyrus Murder support High Availability configurations?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/r-pop3-logging.html">Can I configure pop3d to log amount and size of messages fetched by user?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/r-publicssharedfolders.html">How can I make CyrusSieve work with public shared folders?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/r-subfolders.html">Can I have subfolders not appear under INBOX?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#common-operational-questions">Common Operational Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-acls.html">How do I view ACLs on a mailbox?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-annotations.html">What annotations are available?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-berkeleydb.html">Why does ctl_cyrusdb -r take so long with Berkeley DB?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-configdir-tempfs.html">Is it safe to put configdir/proc and configdir/lock on a tmpfs filesystem?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-db3-lockers.html">Is the “db3: x Lockers” log message harmful?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-delete-mailbox.html">Why can I not delete a mailbox as an admin user?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-deleted-expired-expunged-purged.html">When is What … Deleted, Expired, Expunged or Purged?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs/o-deleted-expired-expunged-purged.html#users-and-imap-clients-deleting-messages">Users and IMAP Clients Deleting Messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/o-deleted-expired-expunged-purged.html#deleting-folders">Deleting Folders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/o-deleted-expired-expunged-purged.html#where-are-the-messages">Where are the Messages?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-deliverdb-size.html">Why is deliver.db so large?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-freezes.html">I have multiple imapd-SERVICES configured and experience occasional freezes when I try to log in!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-mailbox-doesnotexist.html">Cyrus delivers claims that the mailbox does not exist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-mixedcase.html">Why is mail being rejected with No Mailbox found due to MiXed CaSe incoming e-mail?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-otherdatabases.html">Can I use MySQL (or another SQL database) as the primary mail store?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-pop3slow.html">Why do POP3 connections take so long, but once the connection is established all is well?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-reconstruct.html">Why does reconstruct -m not work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-sharedfilesystem-gpfs.html">Shared File Systems GPFS for high availability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-telemetry.html">How to enable telemetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-toomanyprocesses.html">The process count keeps growing!</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs/o-toomanyprocesses.html#reuse-count">1. Reuse count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/o-toomanyprocesses.html#maximum-child-count">2. Maximum child count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/o-toomanyprocesses.html#clean-up-connections-that-are-no-longer-in-use">3. Clean up connections that are no longer in use</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-unable-join-environment.html">“unable to join environment” error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/o-vacation-mailfrom.html">Why does Cyrus set the MAIL FROM address of the sender of vacation responses to ‘&lt;&gt;’?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#common-interoperability-problems">Common Interoperability Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/interop-8bit.html">Why does Cyrus reject 8-bit characters in the headers of my messages?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/interop-barenewlines.html">Why does Cyrus reject messages with “bare newlines”?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/interop-sieve-exim.html">How do I get Cyrus Sieve to play nice with Exim?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../faqs/interop-slow-delivery.html">Why does mail delivery go slow or hang sometimes?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/index.html">IMAP Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release-notes/index.html#currently-stable-version">Currently Stable Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes/index.html#current-development-version">Current Development Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes/index.html#currently-supported-product-series">Currently Supported Product Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../release-notes/index.html#series-2-5">Series 2.5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.5/index.html">Cyrus IMAP 2.5 Releases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../release-notes/index.html#series-2-4">Series 2.4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.4/index.html">Cyrus IMAP 2.4 Releases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.4-dav/index.html">Cyrus IMAP 2.4-caldav Releases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes/index.html#all-versions-going-back-way-back-when">All Versions Going Back Way Back When</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../release-notes/index.html#series-1">Series 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/1/1.x.x.html">Cyrus IMAP 1.x Release Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../release-notes/index.html#series-2-2-0-2-3">Series 2: 2.0 - 2.3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.0/2.0.x.html">Cyrus IMAP 2.0.x Release Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.1/2.1.x.html">Cyrus IMAP 2.1.x Release Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.2/2.2.x.html">Cyrus IMAP 2.2.x Release Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../release-notes/2.3/index.html">Cyrus IMAP 2.3 Releases</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contribute.html#contribute-financially">Contribute Financially</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute.html#website-content-contributions">Website Content Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute.html#contribute-code">Contribute Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">IMAP Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/overview.html">Overview of Cyrus development environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/overview.html#the-pre-requisites">The pre-requisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/overview.html#the-components">The components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/installguide.html">Developer Environment Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/installguide.html#cyrus">Cyrus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/installguide.html#arcanist">Arcanist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/installguide.html#setting-up-syslog">Setting up syslog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/basicserver.html">Running a basic server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#update-your-system">1. Update your system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#install-cyrus-3rd-party-dependencies">2. Install Cyrus 3rd party dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#the-cyrus-mail-user">3. The cyrus:mail user</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#setting-up-authentication-with-sasl">4. Setting up authentication with SASL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#enabling-mail-delivery-with-lmtp">5. Enabling mail delivery with LMTP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#protocol-ports">6. Protocol ports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#configuring-cyrus">7. Configuring Cyrus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#launch-cyrus">8. Launch Cyrus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#optional-setting-up-ssl-certificates">Optional: Setting up SSL certificates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#sending-a-test-email">Sending a test email</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#checking-carddav">Checking carddav</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#checking-caldav">Checking caldav</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/basicserver.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/developer-testing.html">Developer Test Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/developer-testing.html#installing-cassandane">Installing Cassandane</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/developer-testing.html#rebuild-cyrus-for-testing">Rebuild Cyrus for Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/developer-testing.html#running-the-tests">Running the tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/developer-testing.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/process.html">Development Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/process.html#coding-style">Coding Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/process.html#making-changes">Making changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/process.html#useful-developer-information">Useful Developer Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/process.html#community-participation">Community Participation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/architecture.html">System Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#high-level-architecture">High Level Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#cyrus-murder">Cyrus Murder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#replication">Replication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/architecture.html#invoking-cyrus">Invoking Cyrus</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/jmap.html">JMAP support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/jmap.html#cyrus-administration">Cyrus administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/jmap.html#jmap-client">JMAP client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/jmap.html#jmap-implementation-in-cyrus">JMAP implementation in Cyrus</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/documentation.html">Contributing to documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/documentation.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/documentation.html#documentation-tools">Documentation Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/documentation.html#checking-the-files">Checking the files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/documentation.html#submitting-updates">Submitting updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/documentation.html#special-tags">Special Tags</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/documentation.html#conventions-man-pages">Conventions: Man Pages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#resources">Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/libraries.html">Developer Libraries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/libraries.html#list-of-libraries">List of Libraries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/docker.html">Docker Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/docker.html#quick-notes">Quick Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/docker.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/docker.html#running-the-tests-yourself">Running the Tests Yourself</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/docker.html#getting-an-interactive-shell">Getting an Interactive Shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/docker.html#functions-for-your-convenience">Functions for Your Convenience</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/docker.html#build-process-steps">Build Process Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#continuous-integration">Continuous Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/pre-configure-fails.html">Error Message: Step <code class="docutils literal notranslate"><span class="pre">pre-configure</span></code> fails on (…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/configure-fails.html">Error Message: Step <code class="docutils literal notranslate"><span class="pre">configure</span></code> fails on (…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/make-fails.html">Error Message: Step <code class="docutils literal notranslate"><span class="pre">make</span></code> fails on (…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/make-check-fails.html">Error Message: Step <code class="docutils literal notranslate"><span class="pre">make-check</span></code> fails on (…)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Cyrus SASL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sasl/getting_started.html">SASL Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#sasl">SASL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#sasl-authentication-mechanisms">SASL Authentication Mechanisms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#security-layers">Security Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#channel-binding">Channel Binding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#realms">Realms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#protocols">Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#cyrus-sasl">Cyrus SASL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#the-glue-library">The Glue Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#auxiliary-properties">Auxiliary Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/getting_started.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sasl/auxiliary_properties.html">SASL Auxiliary Properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/auxiliary_properties.html#auxiliary-properties-and-the-glue-layer">Auxiliary Properties and the Glue Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/auxiliary_properties.html#passwords-and-other-data">Passwords and other Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/auxiliary_properties.html#sasldb">sasldb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/auxiliary_properties.html#ldapdb">ldapdb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/auxiliary_properties.html#sql">sql</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/auxiliary_properties.html#user-canonicalization">User Canonicalization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sasl/authentication_mechanisms.html">SASL Authentication Mechanisms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#external">EXTERNAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#anonymous">ANONYMOUS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#plain">PLAIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#login">LOGIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#cram-md5">CRAM-MD5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#digest-md5">DIGEST-MD5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#scram-sha-1">SCRAM-SHA-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#gssapi">GSSAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#gs2-krb5">GS2-KRB5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#gs2-iakerb">GS2-IAKERB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#ntlm">NTLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#srp">SRP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#pssdss">PSSDSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#otp">OTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/authentication_mechanisms.html#non-sasl-authentication">Non-SASL Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sasl/pwcheck.html">SASL Pwcheck</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/pwcheck.html#auxprop">Auxprop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/pwcheck.html#auxprop-hashed">Auxprop-hashed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/pwcheck.html#saslauthd">Saslauthd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/pwcheck.html#authdaemon">Authdaemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/pwcheck.html#alwaystrue">Alwaystrue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/pwcheck.html#auto-transition">Auto Transition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sasl/faq.html">SASL Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/faqs/authorize-vs-authenticate.html">What is the difference between an Authorization ID and a Authentication ID?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/faqs/crammd5-digestmd5.html">Why do CRAM-MD5 and DIGEST-MD5 not work with CyrusSaslauthd?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/faqs/openldap-sasl-gssapi.html">How do I configure OpenLDAP +SASL+GSSAPI?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/faqs/plaintextpasswords.html">Why does CyrusSasl store plaintext passwords in its databases?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sasl/faqs/upgrade-saslv2.html">Why am I having a problem running dbconverter-2 to upgrade from SASLv1 to SASLv2?</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Cyrus IMAP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs v2.5.17</a> &raquo;</li>
      
          <li><a href="../deployment.html">IMAP Configuration Guide</a> &raquo;</li>
      
    <li>Storage Considerations</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/cyrusimap/cyrus-imapd/blob/cyrus-imapd-2.5/docsrc/imap/deployment/storage.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="storage-considerations">
<span id="imap-deployment-storage"></span><h1>Storage Considerations<a class="headerlink" href="#storage-considerations" title="Permalink to this headline">¶</a></h1>
<p>Storage considerations are a complex matter as the various options
provide or restrict one’s ability to adjust the necessary parameters as
the need arises. It is foremost a challenge to clearly articulate and
prioritize the criteria for storage, and map the theory on to a
practical implementation design.</p>
<p>This article intends to provide information and outline details, and
sometimes opinions and recommendations, but it is not a guide to
providing you with the storage solution that you want or require.</p>
<p>Generally, the most important considerations for storage include;</p>
<p><a class="reference internal" href="#imap-deployment-storage-redundancy"><span class="std std-ref">Redundancy</span></a>,</p>
<blockquote>
<div><p>because nothing is as humiliating as losing all your data.</p>
</div></blockquote>
<p><a class="reference internal" href="#imap-deployment-storage-availability"><span class="std std-ref">Availability</span></a>,</p>
<blockquote>
<div><p>because nothing is more stressful than none of your data being
available.</p>
</div></blockquote>
<p><a class="reference internal" href="#imap-deployment-storage-performance"><span class="std std-ref">Performance</span></a>,</p>
<blockquote>
<div><p>because nothing is as annoying as waiting, followed by some more
waiting.</p>
</div></blockquote>
<p><a class="reference internal" href="#imap-deployment-storage-scalability"><span class="std std-ref">Scalability</span></a>,</p>
<blockquote>
<div><p>because <code class="docutils literal notranslate"><span class="pre">-ENOSPC</span></code> is good only when it applies to your stomach.</p>
</div></blockquote>
<p><a class="reference internal" href="#imap-deployment-storage-capacity"><span class="std std-ref">Capacity</span></a>,</p>
<blockquote>
<div><p>because your data must be available, backed up and archived.</p>
</div></blockquote>
<p><a class="reference internal" href="#imap-deployment-storage-cost"><span class="std std-ref">Cost</span></a>,</p>
<blockquote>
<div><p>because you can’t buy a beer or feed a family with an empty wallet.</p>
</div></blockquote>
<p>Storage is not a part of Cyrus IMAP, in that Cyrus IMAP does not ship
a particular storage solution as part of the product, and it has no
particular requirements for storage either.</p>
<p>As such, your SAN, NAS, local disk, local array of disks or network
share or even the flash drive of a Raspberry Pi could be used, although
the following considerations are important:</p>
<ul class="simple">
<li><p>The Cyrus IMAP spool is I/O intensive (large volumes of data are read
and get written).</p></li>
<li><p>The Cyrus IMAP spool consists of many small files.</p></li>
</ul>
<p>As such, we recommend you take into account;</p>
<ul class="simple">
<li><p>The available bandwidth between the IMAP server and the storage
provider, if at all on the network,</p></li>
<li><p>The (network) protocol overhead, if any, should file-level read
and/or write locking be required or implied.</p></li>
<li><p>Atomic file operations.</p></li>
<li><p>Parallel access (such as shared mailboxes or multi-client
attendance).</p></li>
</ul>
<div class="section" id="general-notes-on-storage">
<h2>General Notes on Storage<a class="headerlink" href="#general-notes-on-storage" title="Permalink to this headline">¶</a></h2>
<p>The aforementioned considerations
<a class="reference internal" href="#imap-deployment-storage-redundancy"><span class="std std-ref">Redundancy</span></a>,
<a class="reference internal" href="#imap-deployment-storage-availability"><span class="std std-ref">Availability</span></a>,
<a class="reference internal" href="#imap-deployment-storage-performance"><span class="std std-ref">Performance</span></a>,
<a class="reference internal" href="#imap-deployment-storage-scalability"><span class="std std-ref">Scalability</span></a>,
<a class="reference internal" href="#imap-deployment-storage-capacity"><span class="std std-ref">Capacity</span></a> and
<a class="reference internal" href="#imap-deployment-storage-cost"><span class="std std-ref">Cost</span></a>
are not all of them equally important – not to all organizations, and
not to all requirements when the priorities are set out against the
implied cost of the supposed ideal solution.</p>
<p>They are also not mutually exclusive in that, for example, redundancy
may partly address some of the availability concerns – depending on the
exact nature of the final deployment of course, and backup/recovery
capabilities in turn may partly address redundancy requirements. Neither
necessarily directly addresses availability concerns, however.</p>
<p>What is deemed acceptable is another culprit – more often then not,
operational cost, familiarity of staff with a particular storage
solution, or flexibility of a storage solution (or lack thereof) may get
in the way of an otherwise appropriate storage solution.</p>
<p>We believe that provided a sufficient amount of accurate information,
however, you are able to make an informed choice, and that an informed
choice is always better than an ill-informed one.</p>
</div>
<div class="section" id="redundancy">
<span id="imap-deployment-storage-redundancy"></span><h2>Redundancy<a class="headerlink" href="#redundancy" title="Permalink to this headline">¶</a></h2>
<p>Storage redundancy is achieved through replication of data. It is
important to understand that, as a matter of design principle,
redundancy does not in and by itself provide increased availability.</p>
<p>How redundancy could increase availability depends on the exact
implementation, and the various options for practical implementation
each have their own set of implications for cases of failure and the
need to, under certain circumstances, failover and/or recover.</p>
<p>How redundancy is achieved in an “acceptable” manner is another subject
open to interpretation; it is sometimes deemed acceptable to create
backups daily, and therefore potentially accept the loss of up to one
day’s worth of information from live spools – which may or may not be
recoverable through different means. More commonly however is to not
settle for anything less than real-time replication of data.</p>
<p>While storage ultimately amounts to disks, it is important to understand
that a number of (virtual) devices, channels, links and interfaces exist
between an application operating data on disk <a class="footnote-reference brackets" href="#id7" id="id1">1</a>, and the physical
sectors and blocks or cells of storage on that disk. In a way, this
number of layers can be compared with the <a class="reference external" href="http://en.wikipedia.org/wiki/OSI_model">OSI model for networking</a> –
but it is not the same at all.</p>
<p>This section addresses the most commonly used levels at which
replication can be applied.</p>
<div class="section" id="storage-volume-level-replication">
<h3>Storage Volume Level Replication<a class="headerlink" href="#storage-volume-level-replication" title="Permalink to this headline">¶</a></h3>
<p>When using the term <a class="reference internal" href="../../glossary.html#term-storage-volume-level-replication"><span class="xref std std-term">storage volume level replication</span></a> we mean to
indicate the replication of <a class="reference internal" href="../../glossary.html#term-disk-volumes"><span class="xref std std-term">disk volumes</span></a> as a whole. A
simplistic replication scenario of a data disk between two nodes could
look as follows:</p>
<div class="graphviz"><img src="../../_images/graphviz-b80f67cd42b420174ccaf6b84cef3035197484c9.png" alt="digraph drbd {
        rankdir = LR;
        splines = true;
        overlab = prism;

        edge [color=gray50, fontname=Calibri, fontsize=11];
        node [style=filled, shape=record, fontname=Calibri, fontsize=11];

        subgraph cluster_master {
                label = &quot;Master&quot;;

                color = &quot;#BBFFBB&quot;;
                fontname = Calibri;
                rankdir = TB;
                style = filled;

                &quot;OS Disk 0&quot; [label=&quot;OS Disk&quot;,color=&quot;green&quot;];
                &quot;Data Disk 0&quot; [label=&quot;Data Disk&quot;,color=&quot;green&quot;];
            }

        subgraph cluster_slave {
                label = &quot;Slave&quot;;

                color = &quot;#FFBBBB&quot;;
                fontname = Calibri;
                rankdir = TB;
                style = filled;

                &quot;OS Disk 1&quot; [label=&quot;OS Disk&quot;,color=&quot;green&quot;];
                &quot;Data Disk 1&quot; [label=&quot;Data Disk&quot;,color=&quot;red&quot;];
            }

        &quot;Data Disk 0&quot; -&gt; &quot;Data Disk 1&quot; [label=&quot;One-Way Replication&quot;];
    }" class="graphviz" /></div>
<p>For a fully detailed picture of the internal structures, please see the
<a class="reference external" href="http://www.drbd.org/">DRBD</a> website, the canonical experts on this level of replication.</p>
<p>Normally storage-level replication occurs in such
fashion that it can be compared with a distributed version of a RAID-1
array. This incurs limitations that need to be evaluated carefully.</p>
<p>In a hardware RAID-1 array, storage is physically constrained to a
single node, and pairs of replicated disks are treated as one. In a
software RAID-1 array, it is the operating system’s software RAID driver
that can (must) address the individual disks, but makes the array appear
as a single disk to all higher-level software. Here too, the disks are
physically constrained to one physical node.</p>
<p>In both cases, a <em>single point of control</em> exists with full and
exclusive access to the physical disk device(s), namely the interface
for <em>all higher-level software</em> to interact with the storage.</p>
<p>This is the underlying cause of the storage-level replication conundrum.</p>
<p>To illustrate the conundrum, we use a software RAID-1 array. The
individual disk volumes that make up the RAID-1 array are not hidden
from the rest of the operating system, but more importantly, direct
access to the underlying device is not prohibited. With an example pair
<code class="docutils literal notranslate"><span class="pre">sda2</span></code> and <code class="docutils literal notranslate"><span class="pre">sdb2</span></code>, nothing prevents you from executing <code class="docutils literal notranslate"><span class="pre">mkfs.ext4</span></code>
on <code class="docutils literal notranslate"><span class="pre">/dev/sdb2</span></code> thereby corrupting the array – other than perhaps not
having the necessary administrative privileges.</p>
<p>To further illustrate, position one disk in the RAID-1 array on the
other side of a network (such as is a <a class="reference external" href="http://www.drbd.org/">DRBD</a> topology, as illustrated).
Since now two nodes participate in nurturing the mirrored volume, two
points of control exist – each node controls the access to its local
disk device(s).</p>
<p>Participating nodes are <strong>required</strong> to successfully coordinate their
I/O with one another, which on the level of entire storage volumes is a
very impractical effort with high latency and enormous overhead, should
more than one node be allowed to access the replicated device <a class="footnote-reference brackets" href="#id8" id="id2">2</a>.</p>
<p>It is therefore understood that, using storage level replication;</p>
<ul class="simple">
<li><p>Only one side of the mirrored volume can be active (master), and the
other side must remain passive (slave),</p></li>
<li><p>The active and passive nodes therefore have a cluster solution
implemented to manage application’s failover and management of the
change in replication topology (a slave becomes the I/O master, the
former master becomes the replication slave, and other slaves, if
any, learn about the new master to replicate from),</p></li>
<li><p>Failover implementations include fencing, the STONITH principle,
ensuring no two nodes in parallel perform I/O on the same volume at
any given time.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Storage volume level replication does not protect against filesystem
or payload corruption – the replication happily mirrors the
“faulty” bits as it is completely agnostic to the bits’ meaning and
relevance.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the reasons outlined in this section, storage volume level
replication has only a limited number of Cyrus IMAP deployment
scenarios for which it would be recommended – such as <em>Disaster
Recovery Failover</em>.</p>
</div>
</div>
<div class="section" id="integrated-storage-protocol-level-replication">
<span id="imap-deployment-storage-integrated-storage-protocol-level-replication"></span><h3>Integrated Storage Protocol Level Replication<a class="headerlink" href="#integrated-storage-protocol-level-replication" title="Permalink to this headline">¶</a></h3>
<p>Integrated storage protocol level replication is a different approach to
making storage volumes redundant, applying the replication on a
different level.</p>
<p>Integrated storage protocol level replication isn’t necessarily limited
to replication for the purposes of redundancy only, as it may already
include parallel access controls, distribution across multiple storage
nodes (each providing a part of the total storage volume available),
enabling the use of cheap commodity hardware to provide the individual
parts (called “bricks”) that make up the larger volume.</p>
<p>Additional features may include the use of a geographically oriented set
of parameters for the calculation and assignment of replicated chunks of
data (ie. “brick replication topology”).</p>
<div class="graphviz"><img src="../../_images/graphviz-874f038150e8c41903108cc29b388994fc584aea.png" alt="digraph {
        rankdir = TB;
        splines = true;
        overlab = prism;

        edge [color=gray50, fontname=Calibri, fontsize=11];
        node [style=filled, shape=record, fontname=Calibri, fontsize=11];

        &quot;Storage Client #1&quot; -&gt; &quot;Storage Access Point&quot; [dir=back,color=green];
        &quot;Storage Client #2&quot; -&gt; &quot;Storage Access Point&quot; [dir=back,color=green];
        &quot;Storage Client #3&quot; -&gt; &quot;Storage Access Point&quot; [dir=back,color=green];
        &quot;Storage Client #4&quot; -&gt; &quot;Storage Access Point&quot; [dir=back,color=green];

        subgraph cluster_storage {
                color = green;
                label = &quot;Distributed and/or Replicated Volume Manager w/ Integrated Distributed (File-) Locking&quot;;

                &quot;Storage Access Point&quot; [shape=point,color=green];

                &quot;Brick #1&quot; [color=green];
                &quot;Brick #2&quot; [color=green];
                &quot;Brick #3&quot; [color=green];
                &quot;Brick #4&quot; [color=green];

                &quot;Storage Access Point&quot; -&gt; &quot;Brick #1&quot; [color=green];
                &quot;Storage Access Point&quot; -&gt; &quot;Brick #2&quot; [color=green];
                &quot;Storage Access Point&quot; -&gt; &quot;Brick #3&quot; [color=green];
                &quot;Storage Access Point&quot; -&gt; &quot;Brick #4&quot; [color=green];
            }
    }" class="graphviz" /></div>
<p>Current implementations of this type of technology include <a class="reference external" href="http://www.glusterfs.org">GlusterFS</a>
and <a class="reference external" href="http://ceph.com">Ceph</a>. Put way too simplistically, both technologies apply very
smart ways of storing individual objects, sometimes with additional
facilities for certain object types. How they work exactly is far beyond
the scope of this document.</p>
<p>Both technologies however are considered more efficient for fewer,
larger objects, than they are for more, smaller objects. Both storage
solutions also tend to be more efficient at addressing individual
objects directly, rather than hierarchies of objects (for listing).</p>
<p>This is meant to indicate that while both solutions scale up to millions
of objects, they facilitate a particular <strong>I/O pattern</strong> better than the
I/O pattern typically associated with a large volume of messages in IMAP
spools. More frequent and very short-lived I/O against individual
objects in a filesystem mounted directly causes a significant amount of
overhead in negotiating the access to the objects across the storage
cluster <a class="footnote-reference brackets" href="#id8" id="id3">2</a>.</p>
<p>Both technologies are perfectly suitable for large clusters with
relatively small filesystems (see <a class="reference external" href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Global_File_System_2/ch-considerations.html#s2-fssize-gfs2">Filesystems: Smaller is Better</a>)
if they are mounted directly from the storage clients. They are
particularly feasible if not too many parallel write operations to
individual objects (files) are likely to occur (think, for example, of
web application servers and (asset-)caching proxies).</p>
<p>Alternatively, fewer larger objects could be stored – such as disk
images for a virtualization environment. The I/O patterns internal to
the virtual machine would remain the same, but the I/O pattern of the
storage client (the hypervisor) is the equivalent of a single
lock-and-open when the virtual machine starts.</p>
<p>It is therefore understood that, especially in deployments of a larger
scale, one should not mount a GlusterFS or CephFS filesystem directly
from within an IMAP server, as an individual IMAP mail spool consists of
many very small objects each individually addressed frequently, and in
short-lived I/O operations, and consider the use of these distributed
filesystems for a different level of object storage, such as disk images
for a virtualization environment:</p>
<div class="graphviz"><img src="../../_images/graphviz-3e2b7f81666825fa1c307603cf4d59cc875af591.png" alt="digraph {
           rankdir = TB;
           splines = true;
           overlab = prism;

           edge [color=gray50, fontname=Calibri, fontsize=11];
           node [style=filled, shape=record, fontname=Calibri, fontsize=11];

           subgraph cluster_guests {
                   label = &quot;Guest Nodes&quot;;

                   &quot;Guest #1&quot;;
                   &quot;Guest #2&quot;;
                   &quot;Guest #3&quot;;
               }

           subgraph cluster_hypervisors {
                   label = &quot;Virtualization Platform&quot;;

                   &quot;Hypervisor #1&quot;;
                   &quot;Hypervisor #2&quot;;
               }

           subgraph cluster_storage {
                   color = green;
                   label = &quot;Distributed and/or Replicated Volume
Manager w/ Integrated Distributed (File-) Locking&quot;;

                   subgraph cluster_replbricks1 {
                           label = &quot;Replicated Bricks&quot;;

                           &quot;Brick #1&quot; [color=green];
                           &quot;Brick #3&quot; [color=green];
                       }

                   subgraph cluster_replbricks2 {
                           label = &quot;Replicated Bricks&quot;;

                           &quot;Brick #2&quot; [color=green];
                           &quot;Brick #4&quot; [color=green];
                       }

               }

           &quot;Guest #1&quot; -&gt; &quot;Hypervisor #1&quot; [dir=both,color=green];
           &quot;Guest #2&quot; -&gt; &quot;Hypervisor #1&quot; [dir=both,color=green];
           &quot;Guest #3&quot; -&gt; &quot;Hypervisor #2&quot; [dir=both,color=green];

           &quot;Hypervisor #1&quot; -&gt; &quot;Brick #4&quot; [dir=both,label=&quot;Guest #1&quot;];
           &quot;Hypervisor #1&quot; -&gt; &quot;Brick #3&quot; [dir=both,label=&quot;Guest #2&quot;];
           &quot;Hypervisor #2&quot; -&gt; &quot;Brick #3&quot; [dir=both,label=&quot;Guest #3&quot;];
       }" class="graphviz" /></div>
<p>In this illustration, <em>Hypervisor #1</em> and <em>Hypervisor #2</em> are storage
clients, and replicated bricks hold the disk images of each guest.</p>
<p>Each hypervisor can, in parallel, perform I/O against each individual
disk image, allowing (for example) both <em>Hypervisor #1</em> and
<em>Hypervisor #2</em> to run guests with disk images for which <em>Brick #3</em> has
been selected as the authoritative copy.</p>
</div>
<div class="section" id="application-level-replication">
<span id="deployment-application-replication"></span><h3>Application Level Replication<a class="headerlink" href="#application-level-replication" title="Permalink to this headline">¶</a></h3>
<p>Yet another means to provide redundancy of data is to use application-
level replication where available.</p>
<p>Famous examples include database server replication, where one or more
MySQL masters are used for write operations, and one or more MySQL
slaves are used for read operations, and LDAP replication.</p>
<p>Cyrus IMAP can also replicate its mail spools to other systems, such
that multiple backends hold the payload served to your users.</p>
</div>
<div class="section" id="shared-storage-generic">
<h3>Shared Storage (Generic)<a class="headerlink" href="#shared-storage-generic" title="Permalink to this headline">¶</a></h3>
<p>Contrary to popular belief, all shared storage – NFS, iSCSI and FC
alike – are <strong>not</strong> storage devices. They are <em>network protocols</em> for
which the application just so happens to be storage – with perhaps the
exception to the rule being Fiber-Channel not strictly cohering to the
<a class="reference external" href="http://en.wikipedia.org/wiki/OSI_model">OSI model for networking</a>, although its own 5-layer model equates.</p>
<p>iSCSI and Fiber-Channel LUNs however are <em>mapped</em> to storage devices by
your favorite operating system’s drivers for each technology, or
possibly by a hardware device (an <a class="reference internal" href="#term-HBA"><span class="xref std std-term">HBA</span></a>, or in iSCSI, an
<em>initiator</em>).</p>
<p>As such, use of these network protocols for which the purpose just so
happens to be storage does <strong>not</strong> provide redundancy.</p>
<p>It is imperitive this is understood and equally well applied in planning
for storage infrastructure, or that your storage appliance vendor or
consultancy partner is trusted in their judgement.</p>
</div>
<div class="section" id="shared-storage-nfs">
<h3>Shared Storage (NFS)<a class="headerlink" href="#shared-storage-nfs" title="Permalink to this headline">¶</a></h3>
<p>Use of the Networked File System (NFS) in and by itself does <strong>not</strong>
provide redundancy, although the underlying storage volume might be
replicated.</p>
<p>For a variety of reasons, the use of <a class="reference external" href="http://www.time-travellers.org/shane/papers/NFS_considered_harmful.html">NFS is considered harmful</a> and is
therefore, and for other reasons,  most definitely not recommended for
Cyrus IMAP IMAP spool storage, or any other storage related to
functional components of Cyrus IMAP itself – IMAP, LDAP, SQL, etc.</p>
<p>Most individual concerns can be addressed separately, and some should or
must already be resolved to address other potentially problematic areas
of a given infrastructure, regardless of the use of NFS.</p>
<p>A couple of concerns however only have <em>workarounds</em>, not solutions –
such as disabling locking – and a number of concerns have no solution
at all.</p>
<p>One penalty to address is the inability for NFS mounted volumes to cache
I/O, known as in-memory buffer caching.</p>
<p>A technology called <a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/ch-fscache.html">FS Cache</a> can facilitate eliminating round-trip-
incurred network-latency, but is still a filesystem-backed solution
(for which filesystem the local kernel applies buffer caching), requires
yet another daemon, and introduces yet another layer of synchronisity to
be maintained – aside from <a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/fscachelimitnfs.html">other limitations</a>.</p>
<p>An NFS-backed storage volume can still be used for fewer, larger files,
such as guest disk images.</p>
</div>
<div class="section" id="shared-storage-iscsi-or-fc-luns">
<h3>Shared Storage (iSCSI or FC LUNs)<a class="headerlink" href="#shared-storage-iscsi-or-fc-luns" title="Permalink to this headline">¶</a></h3>
<p>Both iSCSI LUNs and Fiber-Channel LUNs facilitate attaching a networked
block storage device as if it were a local disk (creating devices
similar to <code class="docutils literal notranslate"><span class="pre">/dev/sd{a,b,c,d}</span></code> etc.).</p>
<p>Since such a LUN is available over a “network” infrastructure, it may be
shared between multiple nodes but when it is, nodes need to coordinate
their I/O on some other level.</p>
<p>With an example case of hypervisors, either <a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Logical_Volume_Manager_Administration/LVM_Cluster_Overview.html">Cluster LVM</a> <a class="footnote-reference brackets" href="#id9" id="id4">3</a> or
<a class="reference external" href="http://en.wikipedia.org/wiki/GFS2">GFS</a> <a class="footnote-reference brackets" href="#id10" id="id5">4</a> could be used to protect against corruption of the LUN.</p>
</div>
</div>
<div class="section" id="availability">
<span id="imap-deployment-storage-availability"></span><h2>Availability<a class="headerlink" href="#availability" title="Permalink to this headline">¶</a></h2>
<p>Availability of storage too can be achieved via multiple routes. In one
of the aforementioned technologies, replicated bricks both available
real-time and online, in a parallel read-write capacity, provided high-
availability through redundancy (see
<a class="reference internal" href="#imap-deployment-storage-integrated-storage-protocol-level-replication"><span class="std std-ref">Integrated Storage Protocol Level Replication</span></a>).</p>
<p>An existing chunk of storage you might have is likely backed by a level
of RAID, with redundancy through mirroring individual disk volumes
and/or the inline calculation of parity, and perhaps also some spare
disks to replace those that are kicked or fall out of line.</p>
<p>Further features might include battery-backed I/O controllers, redundant
power supplies connected to different power groups, a further UPS and
a diesel generator (you start up once a month, right?).</p>
<p>The availability features of a data center are beyond the scope of this
document, but when we speak of availability with regards to storage, we
intend to speak of immediate, instant, online availability with
automated failover (such as the RAID array) – and more prominently,
without interruption.</p>
<div class="section" id="multipath">
<h3>Multipath<a class="headerlink" href="#multipath" title="Permalink to this headline">¶</a></h3>
<p>Multipath is an enhancement technique in which multiple paths that are
available to the storage can be balanced, shaped and failed over
automatically. Imagine the following networking diagram:</p>
<div class="graphviz"><img src="../../_images/graphviz-d864df8e76484bb59fbde74d5aad504edcbe7b07.png" alt="digraph {
        rankdir = TB;
        splines = true;
        overlab = prism;

        edge [color=gray50, fontname=Calibri, fontsize=11];
        node [style=filled, shape=record, fontname=Calibri, fontsize=11];

        &quot;Node&quot;;

        &quot;Switch #1&quot;; &quot;Switch #2&quot;;

        &quot;Canister #1&quot;; &quot;Canister #2&quot;;

        &quot;iSCSI Target #1&quot;, &quot;iSCSI Target #2&quot;;

        &quot;Node&quot; -&gt; &quot;Switch #1&quot; [dir=none]
        &quot;Node&quot; -&gt; &quot;Switch #2&quot; [dir=none];

        &quot;Switch #1&quot; -&gt; &quot;Canister #1&quot; [dir=none];
        &quot;Switch #1&quot; -&gt; &quot;Canister #2&quot; [dir=none];

        &quot;Switch #2&quot; -&gt; &quot;Canister #1&quot; [dir=none];
        &quot;Switch #2&quot; -&gt; &quot;Canister #2&quot; [dir=none];

        &quot;Canister #1&quot; -&gt; &quot;iSCSI Target #1&quot; [dir=none];
        &quot;Canister #1&quot; -&gt; &quot;iSCSI Target #2&quot; [dir=none];

        &quot;Canister #2&quot; -&gt; &quot;iSCSI Target #1&quot; [dir=none];
        &quot;Canister #2&quot; -&gt; &quot;iSCSI Target #2&quot; [dir=none];
    }" class="graphviz" /></div>
<p>The <em>null</em> situation is depicted in the previous wiring diagram. When
multipath kicks in, primary vs. secondary paths will be chosen for each
individual target (that is unique). However, the system maintains a list
of potential paths, and continuously monitors all paths for their
viability.</p>
<p>In the example, for <em>Node</em> attaching to <em>iSCSI Target #1</em> results in up
to 4 paths to <em>iSCSI Target #1</em> – <em>4</em> paths, not <em>8</em>, because the
networking of <em>Switch #1</em> and <em>Switch #2</em> is not considered a path with
iSCSI – <em>two nodes</em> and <em>two send targets each</em>.</p>
<p>Multipath chooses one path to the available storage:</p>
<div class="graphviz"><img src="../../_images/graphviz-ad825d5a8fcee581a89d73028c94f8708bc2bc1f.png" alt="digraph {
        rankdir = TB;
        splines = true;
        overlab = prism;

        edge [color=gray50, fontname=Calibri, fontsize=11];
        node [style=filled, shape=record, fontname=Calibri, fontsize=11];

        &quot;Node&quot;;

        &quot;Switch #1&quot; [color=green];
        &quot;Switch #2&quot;;

        &quot;Canister #1&quot;;
        &quot;Canister #2&quot; [color=green];

        &quot;iSCSI Target #1&quot; [color=green];
        &quot;iSCSI Target #2&quot;;

        &quot;Node&quot; -&gt; &quot;Switch #1&quot; [dir=none,color=green]
        &quot;Node&quot; -&gt; &quot;Switch #2&quot; [dir=none];

        &quot;Switch #1&quot; -&gt; &quot;Canister #1&quot; [dir=none];
        &quot;Switch #1&quot; -&gt; &quot;Canister #2&quot; [dir=none,color=green];

        &quot;Switch #2&quot; -&gt; &quot;Canister #1&quot; [dir=none];
        &quot;Switch #2&quot; -&gt; &quot;Canister #2&quot; [dir=none];

        &quot;Canister #1&quot; -&gt; &quot;iSCSI Target #1&quot; [dir=none];
        &quot;Canister #1&quot; -&gt; &quot;iSCSI Target #2&quot; [dir=none];

        &quot;Canister #2&quot; -&gt; &quot;iSCSI Target #1&quot; [dir=none,color=green];
        &quot;Canister #2&quot; -&gt; &quot;iSCSI Target #2&quot; [dir=none];
    }" class="graphviz" /></div>
<p>Should one port, bridge, controller, switch or cable fail, then the I/O
can fall back on to any of the remaining available paths.</p>
<p>As per the example, this might mean the following (with <em>Canister #2</em>
failing):</p>
<div class="graphviz"><img src="../../_images/graphviz-eb779c0c460d8423f9ba7757cfa26891ffbbdc9b.png" alt="digraph {
        rankdir = TB;
        splines = true;
        overlab = prism;

        edge [color=gray50, fontname=Calibri, fontsize=11];
        node [style=filled, shape=record, fontname=Calibri, fontsize=11];

        &quot;Node&quot;;

        &quot;Switch #1&quot; [color=green];
        &quot;Switch #2&quot;;

        &quot;Canister #1&quot; [color=green];
        &quot;Canister #2&quot; [color=red];

        &quot;iSCSI Target #1&quot; [color=green];
        &quot;iSCSI Target #2&quot;;

        &quot;Node&quot; -&gt; &quot;Switch #1&quot; [dir=none,color=green]
        &quot;Node&quot; -&gt; &quot;Switch #2&quot; [dir=none];

        &quot;Switch #1&quot; -&gt; &quot;Canister #1&quot; [dir=none,color=green];
        &quot;Switch #1&quot; -&gt; &quot;Canister #2&quot; [dir=none,color=red];

        &quot;Switch #2&quot; -&gt; &quot;Canister #1&quot; [dir=none];
        &quot;Switch #2&quot; -&gt; &quot;Canister #2&quot; [dir=none];

        &quot;Canister #1&quot; -&gt; &quot;iSCSI Target #1&quot; [dir=none,color=green];
        &quot;Canister #1&quot; -&gt; &quot;iSCSI Target #2&quot; [dir=none];

        &quot;Canister #2&quot; -&gt; &quot;iSCSI Target #1&quot; [dir=none,color=red];
        &quot;Canister #2&quot; -&gt; &quot;iSCSI Target #2&quot; [dir=none];
    }" class="graphviz" /></div>
</div>
</div>
<div class="section" id="performance">
<span id="imap-deployment-storage-performance"></span><h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<div class="section" id="storage-tiering">
<h3>Storage Tiering<a class="headerlink" href="#storage-tiering" title="Permalink to this headline">¶</a></h3>
<p>Storage tiering includes the combination of different types of storage
or storage volumes with different performance expectations within the
infrastructure, so that a larger volume of slower, cheaper storage can
be used for items that are not used that much, and/or are not that
important for day-to-day operations, while a smaller volume of faster,
more expensive storage can be used for items that are frequently
accessed and have significant importance to everyday use.</p>
<p>The Cyrus IMAP administrator guide has a section on using
<a class="reference internal" href="../admin/tweaking.html#admin-tweaking-cyrus-imapd-storage-tiering"><span class="std std-ref">Storage Tiering</span></a> to tweak Cyrus IMAP
performance, to illustrate various opportunities to make optimal use of
your storage.</p>
<p>As a general rule of thumb, you could divide
<a class="reference internal" href="../../glossary.html#term-operating-system-disks"><span class="xref std std-term">operating system disks</span></a> and <a class="reference internal" href="../../glossary.html#term-payload-disks"><span class="xref std std-term">payload disks</span></a>; the operating
system disk could hold your base installation of a node, including
everything in the root (<code class="docutils literal notranslate"><span class="pre">/</span></code>) filesystem, while your payload disk(s)
hold the files and directories that contain the system’s service(s)
payload (such as <code class="docutils literal notranslate"><span class="pre">/var/lib/mysql/</span></code>, <code class="docutils literal notranslate"><span class="pre">/var/spool/imap/</span></code>,
<code class="docutils literal notranslate"><span class="pre">/var/lib/imap/</span></code>, <code class="docutils literal notranslate"><span class="pre">/var/lib/dirsrv/</span></code>, etc.).</p>
<p>Distributing what is and what is not frequently used may be a cumbersome
task for administrators. Some storage vendor’s appliances offer
automated storage tiering, where some disks in the appliance are SSDs,
while others are SATA or SAS HDDs, and the appliance itself tiers the
storage.</p>
<p>A similar solution is available to Linux nodes, through <a class="reference external" href="http://en.wikipedia.org/wiki/Dm-cache">dm-cache</a>,
provided they run a recent kernel.</p>
</div>
<div class="section" id="disk-buffering">
<h3>Disk Buffering<a class="headerlink" href="#disk-buffering" title="Permalink to this headline">¶</a></h3>
<p>Reading from a disk is considered very, very slow when compared to
accessing a node’s (real) memory. While dependent on the particular I/O
pattern of an application, it is not uncommon at all for an application
to read the same part of a disk volume several times during a relatively
short period of time.</p>
<p>In Cyrus IMAP, for example, while a user is logged in, a mail
folder’s <code class="file docutils literal notranslate"><span class="pre">cyrus.index</span></code> is read more frequently than it is
written to – such as when refreshing the folder view, when opening a
message in the folder, when replying to a message, etc.</p>
<p>It is important to appreciate the impact of <a class="reference external" href="http://www.tldp.org/LDP/sag/html/buffer-cache.html">memory-based buffer cache</a>
for this type of I/O on the overall performance of the environment.</p>
<p>Should no (local) memory-based buffer cache be available, because for
example you are using a network filesystem (NFS, GlusterFS, etc.), then
it is extremely important to appreciate the consequences in terms of the
performance expectations.</p>
</div>
<div class="section" id="readahead">
<h3>Readahead<a class="headerlink" href="#readahead" title="Permalink to this headline">¶</a></h3>
<p>Reading ahead is a feature in which – in a future-predicting,
anticipatory fashion – a chunk of storage is read in addition to the
chunk of storage actually being requested.</p>
<p>A common application of read-ahead is to record all files accessed
during the boot process of a node, such that later boot sequences can
read files from disk, and insert them in to the
<a class="reference external" href="http://www.tldp.org/LDP/sag/html/buffer-cache.html">memory-based buffer cache</a> ahead of software actually issuing the call
to read the file. The file’s contents can now be reproduced from the
faster (real) memory rather then from the slow disk.</p>
<p>Readahead generally does not matter for small files, unless read
operations work on a collective of aggregate message files. It does
however matter for attached devices on infrastructural components such
as hypervisors, where entire block devices (for the guest) are the files
or block devices being read.</p>
<p>The ideal setting for readahead depends on a variety of factors and can
usually only be established by monitoring an environment and tweaking
the setting (followed by some more monitoring).</p>
</div>
</div>
<div class="section" id="scalability">
<span id="imap-deployment-storage-scalability"></span><h2>Scalability<a class="headerlink" href="#scalability" title="Permalink to this headline">¶</a></h2>
<p>When originally planning for storage capacity, a few things are to be
taken in to account. We’ll point these out and address them later in
this section.</p>
<p>Generically speaking, when storage capacity is planned for initially,
a certain period of time is used to establish how much storage might be
required (for that duration).</p>
<p>However, let’s suppose regulatory provisions dictate a period of 10
years of business communications need to be preserved. How does one
accurately predict the volume of communications over the next 10 years?</p>
<p>Let’s suppose your organization is in flux, expanding or contracting as
businesses do at times, or budget cuts and unexpected extra tasks to
your organization might incur. Or when the organization takes over or
otherwise incorporates another.</p>
<p>Today’s storage coming with a certain price-tag, and tomorrow’s with a
different one, it can be an interesting exercise to plan for storage to
grow organicly as needed, rather than make large investments to provide
capacity that may only be used years from today, or not be used at all,
or turn out to still not be sufficient.</p>
<p>One may also consider planning for the future expansion of the storage
solution chosen today, possibly including significant changes in
requirements (larger mailboxes).</p>
<div class="section" id="data-retention">
<h3>Data Retention<a class="headerlink" href="#data-retention" title="Permalink to this headline">¶</a></h3>
<p>Cyrus IMAP by default does not delete IMAP spool contents from the
filesystem for a period of 69 days.</p>
<p>This means that when a 100 users each have 1 GB of quota, the actual
data footprint might grow way beyond 100 GB on disk.</p>
<p>Depending on the nature of how you use Cyrus IMAP, a reasonable
expectation can be formulated and used for calculating the likely amount
of disk space used in addition to the content that continues to count
towards quota.</p>
<p>For example, if a large amount of message traffic ends up in a shared
folder that many users read messages from and respond to (such as might
be the case for an <a class="reference external" href="mailto:info&#37;&#52;&#48;example&#46;org">info<span>&#64;</span>example<span>&#46;</span>org</a> email address), then around triple
the amount of traffic per month will continue to be stored on disk, plus
what you decide is still current and not deleted by users (the “live
size”).</p>
</div>
<div class="section" id="shared-folders">
<h3>Shared Folders<a class="headerlink" href="#shared-folders" title="Permalink to this headline">¶</a></h3>
<p>Shared folders (primarily those to which mail is delivered) do not, by
default, have any quota on them. They are also not purged by default. As
such, they could grow infinitely (until disks run out of space).</p>
<p>A busy mailing list used for human communications, such as
<a class="reference external" href="mailto:devel&#37;&#52;&#48;lists&#46;fedoraproject&#46;org">devel<span>&#64;</span>lists<span>&#46;</span>fedoraproject<span>&#46;</span>org</a>, can be expected to grow to as much as 1
GB of data foot print on disk over a period of 3 years – at a message
rate of &lt; ~100 a day and without purging.</p>
<p>A mailing list with automated messages generated from applications, such
as <a class="reference external" href="mailto:bugs-list&#37;&#52;&#48;kde&#46;org">bugs-list<span>&#64;</span>kde<span>&#46;</span>org</a>, which is notified of all ticket changes for KDE’s
upstream Bugzilla, can be expected to grow to up to 3.5 GB over the same
period – at a message rate of ~300 per day and without purging.</p>
</div>
<div class="section" id="user-s-groupware-folders">
<h3>User’s Groupware Folders<a class="headerlink" href="#user-s-groupware-folders" title="Permalink to this headline">¶</a></h3>
<p>Users tend not to clean up their calendars, removing old appointments
that have no bearing on today’s views/operations any longer. Kolab
Groupware does not (yet) provide means to purge these items. They do
however count towards a user’s quota.</p>
</div>
</div>
<div class="section" id="capacity">
<span id="imap-deployment-storage-capacity"></span><h2>Capacity<a class="headerlink" href="#capacity" title="Permalink to this headline">¶</a></h2>
<p>Regardless of the volume of storage in total, this section relates to
the volume of storage allocated to any one singular specific purpose in
Cyrus IMAP, and capacity planning in light of that (not the layer
providing the storage).</p>
<p>Archiving and e-Discovery notwithstanding, the largest chunks of data
volume you are going to find in Cyrus IMAP are the live IMAP
spools.</p>
<p>Let each individual IMAP spool be considered a volume, or part of a
volume if you feel inclined to share volumes across Cyrus IMAP backend
instances. Regardless, you need a filesystem <strong>somewhere</strong> (even if the
bricks building the volume are distributed) – the recommended
restrictions you should put forth to the individual chunks of storage
lay therein.</p>
<p>Saturating the argument to make a point, imagine, if you will, a million
users with one gigabyte of data each. Just the original, minimal data
footprint is now around and about one petabyte.</p>
<p>Performing a filesystem check (<strong class="command">fsck.ext4</strong> comes to mind) on a
single one petabyte volume will be prohibitively expensive simply
considering the duration of the command to complete execution, let alone
successful execution, for your <strong>million</strong> users will not have access to
their data while the command has not finished – again, let alone it
finished successfully.</p>
<p><strong>Solely therefore</strong> would you require a second copy of the groupware
payload, now establishing a minimal data footprint to <strong>two</strong> petabyte.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Also note that the two replicas of one petabyte would, if the
replication occurs at the storage volume level, run the risk of
corrupting both replicas’ filesystems.</p>
</div>
<p>Your requirements for data redundancy aside, filesystem checks needing
to be performed at least regularly <a class="footnote-reference brackets" href="#id11" id="id6">5</a>, if not for the level of
likelihood they need to happen because actual recovery is required,
should be restricted to a volume of data that enables the check to
complete in a timely fashion, and possibly (when no data redundancy is
implemented) even within a timeframe you feel comfortable you can hold
off your users/customers while they have no access to their data.</p>
<p>For filesystem checks to need to happen regularly, is not to say that
such filesystem checks require the node to be taken offline. Should you
use Logical Volume Management (LVM) for example, and not allocate 100%
of the volume group to the logical volume that holds the IMAP spool,
than intermediate filesystem checks can be executed on a snapshot of
said logical volume instead, and while the node remains online, to give
you a generic impression of the filesystem’s health. Given this
information, you can schedule a service window should you feel the need
to check the actual filesystem.</p>
<p>A good article on filesystems, the corruption of data and their causes
and mitigation strategies has been written up by <a class="reference external" href="http://lwn.net">LWN</a>,
<a class="reference external" href="http://lwn.net/Articles/190222/">The 2006 Linux Filesystem Workshop</a>. This article also explains what
it is a filesystem check actually does, and why it is usually configured
to be ran after either a certain amount of delay or number of mounts.</p>
</div>
<div class="section" id="cost">
<span id="imap-deployment-storage-cost"></span><h2>Cost<a class="headerlink" href="#cost" title="Permalink to this headline">¶</a></h2>
<p>When cost is of no concern, multiple vendors of storage solutions will
tell you precisely what you need to hear – I think we’ve all been
there.</p>
<p>When cost is a concern, however, cheaper disks are often slower, fail
faster, and sometimes also do not provide the
<a class="reference internal" href="#imap-deployment-storage-capacity"><span class="std std-ref">Capacity</span></a> desired.</p>
<p>On the other hand, stuffing many consumer-grade SATA III disks in to
some commodity hardware likely raises run-time costs – energy.</p>
<p>However, a chassis of a storage solution usually comes at a higher
price point, and therefore expands capacity with relatively large
chunks, which may not be what you require at that moment.</p>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Applications may also operate on data not stored on disk at all,
which is another common avenue potentially resulting in loss of data
– or <em>corruption</em>, which is merely a type of data-loss.</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>With read operations, the other node(s) must be blocked from
writing, and with write operations, the other node(s) must be
blocked from reading and writing.</p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>When using ClusterLVM, you would use logical volumes as disks for
your guests.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>When using GFS, you would mount the GFS filesystem partition on each
hypervisor and use disk image files.</p>
</dd>
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Execute filesystem checks regularly to increase your level of
confidence, that should emergency repairs need to be performed, you
are able to recover swiftly.</p>
<p>The <a class="reference internal" href="#term-MTBF"><span class="xref std std-term">MTBF</span></a> of a stable filesystem has most often been subject
to the failure of the underlying disk, with the filesystem unable to
recover (in time) from the underlying disk failing (partly).</p>
</dd>
</dl>
<dl class="glossary simple">
<dt id="term-MTBF">MTBF<a class="headerlink" href="#term-MTBF" title="Permalink to this term">¶</a></dt><dd><p>Mean Time Between Failures</p>
</dd>
</dl>
<dl class="glossary simple">
<dt id="term-HBA">HBA<a class="headerlink" href="#term-HBA" title="Permalink to this term">¶</a></dt><dd><p>Host Bus Adapter - connects a host system (computer) to other network and storage devices</p>
</dd>
</dl>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="supported-platforms.html" class="btn btn-neutral float-right" title="Supported Platforms and System Requirements" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="performance_recommendations.html" class="btn btn-neutral" title="Performance Recommendations" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1993-2017, The Cyrus Team.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4 using a modified <a href="https://readthedocs.org">Read the Docs</a> <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.5.17',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
<!--      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      }); -->
  </script>
   

</body>
</html>